{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "blueprintSchema.json",
    "type": "object",
    "additionalProperties": false,
    "properties": {
        "blueprint": { "$ref": "blueprintSchema.json#/definitions/blueprint" },
        "blueprint_book": { "$ref": "blueprintSchema.json#/definitions/blueprint_book" }
    },
    "definitions": {
        "position": {
            "type": "object",
            "required": ["x", "y"],
            "additionalProperties": false,
            "properties": {
                "x": { "type": "number" },
                "y": { "type": "number" }
            }
        },
        "signal": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "name": {
                    "type": "string",
                    "itemFluidSignalName": true
                },
                "type": {
                    "type": "string",
                    "enum": ["item", "virtual", "fluid"]
                }
            }
        },
        "ComparatorString": {
            "type": "string",
            "enum": ["<", ">", "≤", "≥", "=", "≠"]
        },
        "CompareType": {
            "type": "string",
            "enum": ["and", "or"]
        },
        "BlueprintItemIDAndQualityIDPair": {
            "type": "object",
            "required": ["name"],
            "additionalProperties": false,
            "properties": {
                "name": {
                    "type": "string",
                    "itemName": true
                },
                "quality": {
                    "type": "string"
                }
            }
        },
        "InventoryPosition": {
            "type": "object",
            "required": ["inventory", "stack"],
            "additionalProperties": false,
            "properties": {
                "inventory": {
                    "type": "integer"
                },
                "stack": { "type": "integer" },
                "count": { "type": "integer" }
            }
        },
        "ItemInventoryPositions": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "in_inventory": {
                    "type": "array",
                    "items": {
                        "$ref": "blueprintSchema.json#/definitions/InventoryPosition"
                    }
                },
                "grid_count": {
                    "type": "integer"
                }
            }
        },
        "BlueprintInsertPlan": {
            "type": "object",
            "required": ["id", "items"],
            "additionalProperties": false,
            "properties": {
                "id": {
                    "$ref": "blueprintSchema.json#/definitions/BlueprintItemIDAndQualityIDPair"
                },
                "items": {
                    "$ref": "blueprintSchema.json#/definitions/ItemInventoryPositions"
                }
            }
        },
        "LogisticFilter": {
            "type": "object",
            "required": ["index", "count"],
            "additionalProperties": false,
            "properties": {
                "index": {
                    "type": "integer"
                },
                "name": {
                    "type": "string",
                    "itemFluidSignalName": true
                },
                "type": {
                    "type": "string",
                    "enum": ["item", "virtual", "fluid"]
                },
                "quality": {
                    "type": "string"
                },
                "comparator": {
                    "$ref": "blueprintSchema.json#/definitions/ComparatorString"
                },
                "count": {
                    "type": "integer"
                },
                "max_count": {
                    "type": "integer"
                },
                "minimum_delivery_count": {
                    "type": "integer"
                },
                "import_from": {
                    "type": "string"
                }
            }
        },
        "LogisticSection": {
            "type": "object",
            "required": ["index"],
            "additionalProperties": false,
            "properties": {
                "index": {
                    "type": "integer"
                },
                "filters": {
                    "type": "array",
                    "items": {
                        "$ref": "blueprintSchema.json#/definitions/LogisticFilter"
                    }
                },
                "group": {
                    "type": "string"
                },
                "multiplier": {
                    "type": "number"
                },
                "active": {
                    "type": "number"
                }
            }
        },
        "LogisticSections": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "sections": {
                    "type": "array",
                    "items": {
                        "$ref": "blueprintSchema.json#/definitions/LogisticSection"
                    }
                },
                "trash_not_requested": {
                    "type": "boolean"
                },
                "request_from_buffers": {
                    "type": "boolean"
                }
            }
        },
        "SlotFilter": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "index": {
                    "type": "integer"
                },
                "name": {
                    "type": "string"
                }
            }
        },
        "InfinityMode": {
            "type": "string",
            "enum": ["at-least", "at-most", "exactly", "add", "remove"]
        },
        "CircuitNetworkSelection": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "red": {
                    "type": "boolean"
                },
                "green": {
                    "type": "boolean"
                }
            }
        },
        "DeciderCombinatorCondition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "first_signal": {
                    "$ref": "blueprintSchema.json#/definitions/signal"
                },
                "first_signal_networks": {
                    "$ref": "blueprintSchema.json#/definitions/CircuitNetworkSelection"
                },
                "second_signal": {
                    "$ref": "blueprintSchema.json#/definitions/signal"
                },
                "second_signal_networks": {
                    "$ref": "blueprintSchema.json#/definitions/CircuitNetworkSelection"
                },
                "constant": { "type": "integer" },
                "comparator": {
                    "$ref": "blueprintSchema.json#/definitions/ComparatorString"
                },
                "compare_type": {
                    "$ref": "blueprintSchema.json#/definitions/CompareType"
                }
            }
        },
        "DeciderCombinatorOutput": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "signal": {
                    "$ref": "blueprintSchema.json#/definitions/signal"
                },
                "copy_count_from_input": {
                    "type": "boolean"
                },
                "constant": { "type": "integer" },
                "networks": {
                    "$ref": "blueprintSchema.json#/definitions/CircuitNetworkSelection"
                }
            }
        },
        "wireColor": {
            "type": "array",
            "items": {
                "type": "object",
                "required": ["entity_id"],
                "additionalProperties": false,
                "properties": {
                    "entity_id": { "type": "integer" },
                    "circuit_id": { "type": "integer" },
                    "wire_id": { "type": "integer" }
                }
            }
        },
        "connSide": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "red": { "$ref": "blueprintSchema.json#/definitions/wireColor" },
                "green": { "$ref": "blueprintSchema.json#/definitions/wireColor" }
            }
        },
        "condition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "comparator": {
                    "$ref": "blueprintSchema.json#/definitions/ComparatorString"
                },
                "constant": { "type": "integer" },
                "first_signal": { "$ref": "blueprintSchema.json#/definitions/signal" },
                "second_signal": { "$ref": "blueprintSchema.json#/definitions/signal" }
            }
        },
        "ItemFilter": {
            "type": "object",
            "required": ["index", "name"],
            "additionalProperties": false,
            "properties": {
                "index": { "type": "integer" },
                "name": {
                    "type": "string",
                    "itemName": true
                },
                "quality": {
                    "type": "string"
                },
                "comparator": {
                    "$ref": "blueprintSchema.json#/definitions/ComparatorString"
                }
            }
        },
        "InventoryWithFilters": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "bar": { "type": "integer" },
                "filters": {
                    "type": "array",
                    "items": {
                        "$ref": "blueprintSchema.json#/definitions/ItemFilter"
                    }
                }
            }
        },
        "SplitterFilter": {
            "type": "object",
            "required": ["name"],
            "additionalProperties": false,
            "properties": {
                "name": {
                    "type": "string",
                    "itemName": true
                },
                "quality": {
                    "type": "string"
                },
                "comparator": {
                    "$ref": "blueprintSchema.json#/definitions/ComparatorString"
                }
            }
        },
        "icons": {
            "type": "array",
            "minItems": 1,
            "maxItems": 4,
            "items": {
                "type": "object",
                "required": ["index", "signal"],
                "additionalProperties": false,
                "properties": {
                    "index": {
                        "type": "integer",
                        "enum": [1, 2, 3, 4]
                    },
                    "signal": { "$ref": "blueprintSchema.json#/definitions/signal" }
                }
            }
        },
        "blueprint": {
            "type": "object",
            "required": ["version", "item", "icons"],
            "additionalProperties": false,
            "properties": {
                "version": { "type": "integer" },
                "item": {
                    "type": "string",
                    "const": "blueprint"
                },
                "label": { "type": "string" },
                "description": { "type": "string" },
                "absolute-snapping": { "type": "boolean" },
                "snap-to-grid": {
                    "$ref": "blueprintSchema.json#/definitions/position"
                },
                "position-relative-to-grid": {
                    "$ref": "blueprintSchema.json#/definitions/position"
                },
                "wires": {
                    "type": "array",
                    "items": {
                        "type": "array",
                        "minItems": 4,
                        "maxItems": 4,
                        "items": {
                            "type": "number"
                        }
                    }
                },
                "icons": { "$ref": "blueprintSchema.json#/definitions/icons" },
                "schedules": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "required": ["locomotives", "schedule"],
                        "additionalProperties": false,
                        "properties": {
                            "locomotives": {
                                "type": "array",
                                "items": { "type": "integer" }
                            },
                            "schedule": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "required": ["station", "wait_conditions"],
                                    "additionalProperties": false,
                                    "properties": {
                                        "station": { "type": "string" },
                                        "wait_conditions": {
                                            "type": "array",
                                            "items": {
                                                "type": "object",
                                                "required": ["compare_type", "type"],
                                                "additionalProperties": false,
                                                "properties": {
                                                    "compare_type": {
                                                        "$ref": "blueprintSchema.json#/definitions/CompareType"
                                                    },
                                                    "type": {
                                                        "type": "string",
                                                        "enum": [
                                                            "time",
                                                            "inactivity",
                                                            "full",
                                                            "empty",
                                                            "item-count",
                                                            "fluid-count",
                                                            "circuit",
                                                            "passenger-present",
                                                            "passenger-not-present"
                                                        ]
                                                    },
                                                    "ticks": { "type": "integer" },
                                                    "condition": {
                                                        "$ref": "blueprintSchema.json#/definitions/condition"
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "entities": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "required": ["entity_number", "name", "position"],
                        "additionalProperties": true,
                        "properties": {
                            "entity_number": { "type": "integer" },
                            "name": {
                                "type": "string",
                                "entityName": true
                            },
                            "position": { "$ref": "blueprintSchema.json#/definitions/position" },
                            "direction": {
                                "type": "integer",
                                "enum": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15],
                                "$comment": "direction, can be ommited if 0"
                            },
                            "type": {
                                "type": "string",
                                "enum": ["input", "output"],
                                "$comment": "direction type, only present if entity is of type underground-belt"
                            },
                            "recipe": {
                                "type": "string",
                                "recipeName": true,
                                "$comment": "recipe name, only present if entity is of type assembling-machine or has fixed_recipe"
                            },
                            "recipe_quality": {
                                "type": "string"
                            },
                            "bar": {
                                "type": "integer",
                                "$comment": "inventory size limitation, only present if entity has inventory_size"
                            },
                            "items": {
                                "oneOf": [
                                    {
                                        "type": "object",
                                        "propertyNames": {
                                            "itemName": true
                                        },
                                        "patternProperties": {
                                            ".*": { "type": "integer" }
                                        },
                                        "$comment": "object, keys are item names and value nr of items, only present if entity is locomotive or has module_specification, for the locomotive it represents fuel and for an entity with module_specification it represents modules"
                                    },
                                    {
                                        "type": "array",
                                        "items": {
                                            "$ref": "blueprintSchema.json#/definitions/BlueprintInsertPlan"
                                        }
                                    }
                                ]
                            },

                            "input_priority": {
                                "type": "string",
                                "enum": ["left", "right"],
                                "$comment": "splitter input priority, only present if entity is of type splitter"
                            },
                            "output_priority": {
                                "type": "string",
                                "enum": ["left", "right"],
                                "$comment": "splitter output priority, only present if entity is of type splitter"
                            },
                            "filter": {
                                "anyOf": [
                                    {
                                        "type": "string",
                                        "itemName": true,
                                        "$comment": "splitter filter for output priority, only present if entity is of type splitter"
                                    },
                                    {
                                        "$ref": "blueprintSchema.json#/definitions/SplitterFilter"
                                    }
                                ]
                            },

                            "station": {
                                "type": "string",
                                "$comment": "train stop station name, only present if entity is train-stop"
                            },
                            "manual_trains_limit": {
                                "type": "integer",
                                "$comment": "trains limit, only present if entity is train-stop"
                            },
                            "color": {
                                "type": "object",
                                "required": ["r", "g", "b", "a"],
                                "additionalProperties": false,
                                "$comment": "only present if entity is locomotive, train-stop or lamp",
                                "properties": {
                                    "r": { "type": "number" },
                                    "g": { "type": "number" },
                                    "b": { "type": "number" },
                                    "a": { "type": "number" }
                                }
                            },
                            "always_on": {
                                "type": "boolean",
                                "$comment": "only present if entity type is lamp"
                            },
                            "orientation": {
                                "type": "number",
                                "$comment": "only present if entity is locomotive, cargo_wagon or fluid_wagon"
                            },
                            "inventory": {
                                "$ref": "blueprintSchema.json#/definitions/InventoryWithFilters",
                                "$comment": "only present if entity is cargo_wagon"
                            },

                            "switch_state": {
                                "type": "boolean",
                                "$comment": "only present if entity is power-switch"
                            },
                            "auto_launch": {
                                "type": "boolean",
                                "$comment": "auto launch, only present if entity is rocket-silo"
                            },
                            "launch_to_orbit_automatically": {
                                "type": "boolean",
                                "$comment": "auto launch, only present if entity is rocket-silo"
                            },
                            "use_transitional_requests": {
                                "type": "boolean",
                                "$comment": "only present if entity is rocket-silo"
                            },
                            "override_stack_size": {
                                "type": "integer",
                                "$comment": "override stack size, only present if entity is of type inserter"
                            },
                            "filter_mode": {
                                "type": "string",
                                "enum": ["whitelist", "blacklist"],
                                "$comment": "only present if entity is of type inserter"
                            },
                            "use_filters": {
                                "type": "boolean",
                                "$comment": "only present if entity is of type inserter"
                            },
                            "filters": {
                                "type": "array",
                                "$comment": "only present if entity is of type container, infinity-container, logistic-container, inserter or loader",
                                "items": { "$ref": "blueprintSchema.json#/definitions/ItemFilter" }
                            },
                            "request_filters": {
                                "oneOf": [
                                    {
                                        "type": "array",
                                        "$comment": "only present if entity is storage-chest, buffer-chest or requester-chest",
                                        "items": {
                                            "type": "object",
                                            "required": ["index", "name"],
                                            "additionalProperties": false,
                                            "properties": {
                                                "index": { "type": "integer" },
                                                "name": {
                                                    "type": "string",
                                                    "itemName": true
                                                },
                                                "count": { "type": "integer" }
                                            }
                                        }
                                    },
                                    {
                                        "$ref": "blueprintSchema.json#/definitions/LogisticSections"
                                    }
                                ]
                            },
                            "request_from_buffers": {
                                "type": "boolean",
                                "$comment": "only present if entity is requester-chest"
                            },

                            "alert_parameters": {
                                "type": "object",
                                "$comment": "only present if entity is programmable-speaker",
                                "additionalProperties": false,
                                "properties": {
                                    "alert_message": { "type": "string" },
                                    "icon_signal_id": {
                                        "$ref": "blueprintSchema.json#/definitions/signal"
                                    },
                                    "show_alert": { "type": "boolean" },
                                    "show_on_map": { "type": "boolean" }
                                }
                            },
                            "parameters": {
                                "type": "object",
                                "$comment": "only present if entity is programmable-speaker",
                                "additionalProperties": false,
                                "properties": {
                                    "playback_volume": { "type": "number" },
                                    "playback_globally": { "type": "boolean" },
                                    "playback_mode": {
                                        "type": "string",
                                        "enum": ["global", "surface", "local"]
                                    },
                                    "volume_controlled_by_signal": { "type": "boolean" },
                                    "volume_signal_id": {
                                        "$ref": "blueprintSchema.json#/definitions/signal"
                                    },
                                    "allow_polyphony": { "type": "boolean" }
                                }
                            },

                            "buffer_size": {
                                "type": "number",
                                "$comment": "only present if entity is electric_energy_interface"
                            },
                            "power_production": {
                                "type": "number",
                                "$comment": "only present if entity is electric_energy_interface"
                            },
                            "power_usage": {
                                "type": "number",
                                "$comment": "only present if entity is electric_energy_interface"
                            },

                            "mode": {
                                "$ref": "blueprintSchema.json#/definitions/InfinityMode",
                                "$comment": "only present if entity is heat_interface"
                            },
                            "temperature": {
                                "type": "number",
                                "$comment": "only present if entity is heat_interface"
                            },

                            "priority-list": {
                                "type": "array",
                                "items": {
                                    "$ref": "blueprintSchema.json#/definitions/SlotFilter"
                                }
                            },
                            "ignore-unprioritised": {
                                "type": "boolean"
                            },
                            "artillery_auto_targeting": {
                                "type": "boolean"
                            },

                            "text": { "type": "string" },
                            "icon": { "$ref": "blueprintSchema.json#/definitions/signal" },
                            "always_show": { "type": "boolean" },
                            "show_in_chart": { "type": "boolean" },

                            "infinity_settings": {
                                "type": "object",
                                "$comment": "only present if entity is infinity_chest or infinity_pipe",
                                "additionalProperties": false,
                                "properties": {
                                    "name": { "type": "string", "fluidName": true },
                                    "mode": {
                                        "$ref": "blueprintSchema.json#/definitions/InfinityMode"
                                    },
                                    "percentage": { "type": "number" },
                                    "temperature": { "type": "number" },
                                    "filters": {
                                        "type": "array",
                                        "items": {
                                            "type": "object",
                                            "required": ["name", "index"],
                                            "additionalProperties": false,
                                            "properties": {
                                                "name": { "type": "string", "itemName": true },
                                                "quality": { "type": "string" },
                                                "mode": {
                                                    "$ref": "blueprintSchema.json#/definitions/InfinityMode"
                                                },
                                                "index": { "type": "integer" },
                                                "count": { "type": "integer" }
                                            }
                                        }
                                    },
                                    "remove_unfiltered_items": { "type": "boolean" }
                                }
                            },

                            "neighbours": {
                                "type": "array",
                                "$comment": "power pole wire connections",
                                "items": { "type": "integer" }
                            },
                            "connections": {
                                "type": "object",
                                "$comment": "wire connections",
                                "additionalProperties": false,
                                "properties": {
                                    "1": { "$ref": "blueprintSchema.json#/definitions/connSide" },
                                    "2": { "$ref": "blueprintSchema.json#/definitions/connSide" },
                                    "Cu0": {
                                        "$ref": "blueprintSchema.json#/definitions/wireColor"
                                    },
                                    "Cu1": { "$ref": "blueprintSchema.json#/definitions/wireColor" }
                                }
                            },
                            "control_behavior": {
                                "type": "object",
                                "additionalProperties": true,
                                "properties": {
                                    "is_on": {
                                        "type": "boolean",
                                        "enum": [false],
                                        "$comment": "only present if entity is constant-combinator"
                                    },
                                    "filters": {
                                        "type": "array",
                                        "$comment": "only present if entity is constant-combinator",
                                        "items": {
                                            "type": "object",
                                            "required": ["index", "count", "signal"],
                                            "additionalProperties": false,
                                            "properties": {
                                                "index": { "type": "integer" },
                                                "count": { "type": "integer" },
                                                "signal": {
                                                    "$ref": "blueprintSchema.json#/definitions/signal"
                                                }
                                            }
                                        }
                                    },
                                    "sections": {
                                        "$ref": "blueprintSchema.json#/definitions/LogisticSections"
                                    },

                                    "use_colors": {
                                        "type": "boolean",
                                        "enum": [true],
                                        "$comment": "only present if entity type is lamp"
                                    },
                                    "color_mode": {
                                        "type": "integer",
                                        "$comment": "only present if entity type is lamp"
                                    },
                                    "red_signal": {
                                        "$ref": "blueprintSchema.json#/definitions/signal",
                                        "$comment": "only present if entity type is lamp"
                                    },
                                    "green_signal": {
                                        "$ref": "blueprintSchema.json#/definitions/signal",
                                        "$comment": "only present if entity type is lamp"
                                    },
                                    "blue_signal": {
                                        "$ref": "blueprintSchema.json#/definitions/signal",
                                        "$comment": "only present if entity type is lamp"
                                    },
                                    "rgb_signal": {
                                        "$ref": "blueprintSchema.json#/definitions/signal",
                                        "$comment": "only present if entity type is lamp"
                                    },

                                    "circuit_set_filters": {
                                        "type": "boolean",
                                        "enum": [true],
                                        "$comment": "only present if entity is of type inserter"
                                    },
                                    "circuit_read_hand_contents": {
                                        "type": "boolean",
                                        "$comment": "only present if entity is of type inserter or transport-belt"
                                    },
                                    "circuit_hand_read_mode": {
                                        "type": "integer",
                                        "enum": [1],
                                        "$comment": "0 = pulse, 1 = hold, only present if entity is of type inserter and circuit_read_hand_contents is true"
                                    },
                                    "circuit_set_stack_size": {
                                        "type": "boolean",
                                        "enum": [true],
                                        "$comment": "only present if entity is of type inserter and override_stack_size is not set"
                                    },
                                    "stack_control_input_signal": {
                                        "$ref": "blueprintSchema.json#/definitions/signal"
                                    },
                                    "circuit_contents_read_mode": {
                                        "type": "integer",
                                        "enum": [0, 1],
                                        "$comment": "0 = pulse, 1 = hold, only present if entity is of type transport-belt and circuit_read_hand_contents is true"
                                    },

                                    "circuit_mode_of_operation": {
                                        "type": "integer",
                                        "$comment": "only present if entity is cargo landing pad, buffer-chest or requester-chest"
                                    },

                                    "read_logistics": {
                                        "type": "boolean",
                                        "$comment": "only present if entity is roboport"
                                    },
                                    "read_items_mode": {
                                        "type": "integer"
                                    },
                                    "read_robot_stats": {
                                        "type": "boolean",
                                        "$comment": "only present if entity is roboport"
                                    },
                                    "available_logistic_output_signal": {
                                        "$ref": "blueprintSchema.json#/definitions/signal"
                                    },
                                    "total_logistic_output_signal": {
                                        "$ref": "blueprintSchema.json#/definitions/signal"
                                    },
                                    "available_construction_output_signal": {
                                        "$ref": "blueprintSchema.json#/definitions/signal"
                                    },
                                    "total_construction_output_signal": {
                                        "$ref": "blueprintSchema.json#/definitions/signal"
                                    },
                                    "roboport_count_output_signal": {
                                        "$ref": "blueprintSchema.json#/definitions/signal"
                                    },

                                    "circuit_read_resources": {
                                        "type": "boolean",
                                        "$comment": "only present if entity is of type mining-drill"
                                    },
                                    "circuit_resource_read_mode": {
                                        "type": "integer",
                                        "enum": [0, 1],
                                        "$comment": "only present if entity is burner-mining-drill or electric-mining-drill and circuit_read_resources is true"
                                    },

                                    "circuit_open_gate": {
                                        "type": "boolean",
                                        "$comment": "only present if entity is stone-wall"
                                    },
                                    "circuit_read_sensor": {
                                        "type": "boolean",
                                        "$comment": "only present if entity is stone-wall"
                                    },

                                    "send_to_train": {
                                        "type": "boolean",
                                        "enum": [false],
                                        "$comment": "only present if entity is train-stop"
                                    },
                                    "read_from_train": {
                                        "type": "boolean",
                                        "enum": [true],
                                        "$comment": "only present if entity is train-stop"
                                    },
                                    "read_stopped_train": {
                                        "type": "boolean",
                                        "enum": [true],
                                        "$comment": "only present if entity is train-stop"
                                    },
                                    "train_stopped_signal": {
                                        "$ref": "blueprintSchema.json#/definitions/signal"
                                    },
                                    "set_trains_limit": {
                                        "type": "boolean",
                                        "enum": [true],
                                        "$comment": "only present if entity is train-stop"
                                    },
                                    "trains_limit_signal": {
                                        "$ref": "blueprintSchema.json#/definitions/signal"
                                    },
                                    "read_trains_count": {
                                        "type": "boolean",
                                        "enum": [true],
                                        "$comment": "only present if entity is train-stop"
                                    },
                                    "trains_count_signal": {
                                        "$ref": "blueprintSchema.json#/definitions/signal"
                                    },

                                    "circuit_close_signal": {
                                        "type": "boolean",
                                        "$comment": "only present if entity is rail-signal"
                                    },
                                    "circuit_read_signal": {
                                        "type": "boolean",
                                        "$comment": "only present if entity is rail-signal, for chain signals: you have the same signals"
                                    },
                                    "red_output_signal": {
                                        "$ref": "blueprintSchema.json#/definitions/signal"
                                    },
                                    "orange_output_signal": {
                                        "$ref": "blueprintSchema.json#/definitions/signal"
                                    },
                                    "green_output_signal": {
                                        "$ref": "blueprintSchema.json#/definitions/signal"
                                    },
                                    "blue_output_signal": {
                                        "$ref": "blueprintSchema.json#/definitions/signal"
                                    },

                                    "output_signal": {
                                        "$ref": "blueprintSchema.json#/definitions/signal"
                                    },
                                    "read_charge": { "type": "boolean" },

                                    "circuit_parameters": {
                                        "type": "object",
                                        "$comment": "only present if entity is programmable-speaker",
                                        "additionalProperties": false,
                                        "properties": {
                                            "instrument_id": { "type": "integer" },
                                            "note_id": { "type": "integer" },
                                            "signal_value_is_pitch": { "type": "boolean" },
                                            "stop_playing_sounds": { "type": "boolean" }
                                        }
                                    },
                                    "parameters": {
                                        "type": "array",
                                        "items": {
                                            "type": "object",
                                            "additionalProperties": false,
                                            "properties": {
                                                "text": { "type": "string" },
                                                "icon": {
                                                    "$ref": "blueprintSchema.json#/definitions/signal"
                                                },
                                                "condition": {
                                                    "$ref": "blueprintSchema.json#/definitions/condition"
                                                }
                                            }
                                        }
                                    },
                                    "decider_conditions": {
                                        "type": "object",
                                        "$comment": "only present if entity is decider-combinator",
                                        "additionalProperties": false,
                                        "properties": {
                                            "comparator": {
                                                "$ref": "blueprintSchema.json#/definitions/ComparatorString"
                                            },
                                            "constant": { "type": "integer" },
                                            "copy_count_from_input": { "type": "boolean" },
                                            "first_signal": {
                                                "$ref": "blueprintSchema.json#/definitions/signal"
                                            },
                                            "first_signal_networks": {
                                                "$ref": "blueprintSchema.json#/definitions/CircuitNetworkSelection"
                                            },
                                            "second_signal": {
                                                "$ref": "blueprintSchema.json#/definitions/signal"
                                            },
                                            "second_signal_networks": {
                                                "$ref": "blueprintSchema.json#/definitions/CircuitNetworkSelection"
                                            },
                                            "output_signal": {
                                                "$ref": "blueprintSchema.json#/definitions/signal"
                                            },
                                            "conditions": {
                                                "type": "array",
                                                "items": {
                                                    "$ref": "blueprintSchema.json#/definitions/DeciderCombinatorCondition"
                                                }
                                            },
                                            "outputs": {
                                                "type": "array",
                                                "items": {
                                                    "$ref": "blueprintSchema.json#/definitions/DeciderCombinatorOutput"
                                                }
                                            }
                                        }
                                    },
                                    "arithmetic_conditions": {
                                        "type": "object",
                                        "$comment": "only present if entity is arithmetic-combinator",
                                        "additionalProperties": false,
                                        "properties": {
                                            "operation": {
                                                "type": "string",
                                                "enum": [
                                                    "+",
                                                    "-",
                                                    "*",
                                                    "/",
                                                    "%",
                                                    "^",
                                                    "<<",
                                                    ">>",
                                                    "AND",
                                                    "OR",
                                                    "XOR"
                                                ]
                                            },
                                            "constant": { "type": "integer" },
                                            "first_constant": { "type": "integer" },
                                            "second_constant": { "type": "integer" },
                                            "first_signal": {
                                                "$ref": "blueprintSchema.json#/definitions/signal"
                                            },
                                            "first_signal_networks": {
                                                "$ref": "blueprintSchema.json#/definitions/CircuitNetworkSelection"
                                            },
                                            "second_signal": {
                                                "$ref": "blueprintSchema.json#/definitions/signal"
                                            },
                                            "second_signal_networks": {
                                                "$ref": "blueprintSchema.json#/definitions/CircuitNetworkSelection"
                                            },
                                            "output_signal": {
                                                "$ref": "blueprintSchema.json#/definitions/signal"
                                            }
                                        }
                                    },
                                    "operation": {
                                        "type": "string",
                                        "enum": [
                                            "select",
                                            "count",
                                            "random",
                                            "quality-transfer",
                                            "rocket-capacity",
                                            "stack-size",
                                            "quality-filter"
                                        ]
                                    },
                                    "select_max": { "type": "boolean" },
                                    "index_signal": {
                                        "$ref": "blueprintSchema.json#/definitions/signal"
                                    },
                                    "index_constant": { "type": "integer" },
                                    "count_signal": {
                                        "$ref": "blueprintSchema.json#/definitions/signal"
                                    },
                                    "random_update_interval": { "type": "integer" },
                                    "select_quality_from_signal": { "type": "boolean" },
                                    "quality_filter": {
                                        "type": "object",
                                        "additionalProperties": false,
                                        "properties": {
                                            "quality": { "type": "string" },
                                            "comparator": {
                                                "$ref": "blueprintSchema.json#/definitions/ComparatorString"
                                            }
                                        }
                                    },
                                    "quality_source_static": { "type": "string" },
                                    "quality_source_signal": {
                                        "$ref": "blueprintSchema.json#/definitions/signal"
                                    },
                                    "quality_destination_signal": {
                                        "$ref": "blueprintSchema.json#/definitions/signal"
                                    },
                                    "circuit_enable_disable": {
                                        "type": "boolean",
                                        "$comment": "only present if entity is of type mining-drill or transport-belt or train-stop"
                                    },
                                    "circuit_enabled": {
                                        "type": "boolean"
                                    },
                                    "circuit_condition_enabled": {
                                        "type": "boolean"
                                    },
                                    "circuit_condition": {
                                        "$ref": "blueprintSchema.json#/definitions/condition"
                                    },
                                    "connect_to_logistic_network": {
                                        "type": "boolean",
                                        "enum": [true],
                                        "$comment": "only present if entity is pump, offshore-pump, train-stop, small-lamp, power-switch or of type: inserter, transport-belt or mining-drill"
                                    },
                                    "logistic_condition": {
                                        "$ref": "blueprintSchema.json#/definitions/condition"
                                    }
                                }
                            }
                        }
                    }
                },
                "tiles": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "required": ["name", "position"],
                        "additionalProperties": false,
                        "properties": {
                            "name": {
                                "type": "string",
                                "tileName": false
                            },
                            "position": { "$ref": "blueprintSchema.json#/definitions/position" }
                        }
                    }
                }
            }
        },
        "blueprint_book": {
            "type": "object",
            "required": ["version", "item", "active_index"],
            "additionalProperties": false,
            "properties": {
                "version": { "type": "integer" },
                "item": {
                    "type": "string",
                    "const": "blueprint-book"
                },
                "label": { "type": "string" },
                "description": { "type": "string" },
                "icons": { "$ref": "blueprintSchema.json#/definitions/icons" },
                "active_index": { "type": "integer" },
                "blueprints": {
                    "type": "array",
                    "minItems": 1,
                    "maxItems": 1000,
                    "items": {
                        "type": "object",
                        "required": ["index"],
                        "additionalProperties": false,
                        "properties": {
                            "index": { "type": "integer" },
                            "blueprint": {
                                "$ref": "blueprintSchema.json#/definitions/blueprint"
                            },
                            "blueprint_book": {
                                "$ref": "blueprintSchema.json#/definitions/blueprint_book"
                            },
                            "upgrade_planner": {
                                "$ref": "blueprintSchema.json#/definitions/upgrade_planner"
                            },
                            "deconstruction_planner": {
                                "$ref": "blueprintSchema.json#/definitions/deconstruction_planner"
                            }
                        }
                    }
                }
            }
        },
        "upgrade_planner": {
            "type": "object"
        },
        "deconstruction_planner": {
            "type": "object"
        }
    }
}
